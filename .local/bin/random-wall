#!/bin/bash

## This script selects a random wallpaper from a specified directory and sets it using `swww`.
## If no directory is provided as an argument, it defaults to `~/Pictures/Wallpapers`.

## Features:
## - Supports multiple image formats (`.jpg`, `.jpeg`, `.png`, `.gif`, `.webp`).
## - Allows specifying a custom wallpaper directory as an argument.
## - Applies a smooth transition effect via `swww`.

## Requirements:
## - `swww`: Required for setting wallpapers.

## Usage:
## - Run without arguments to use the default wallpaper directory.
## - Run with a directory path as an argument to use a custom wallpaper folder.

## Author: Pahasara Dewnith (https://github.com/Pahasara)

wallpaper_dir="${1:-${WALL_DIR:-$HOME/Pictures/Wallpapers}}"

mapfile -t wallpapers < <(find "$wallpaper_dir" -type f \( -iname '*.jpg' -o -iname '*.jpeg' -o -iname '*.png' -o -iname '*.gif' -o -iname '*.webp' \))

if [[ ${#wallpapers[@]} -eq 0 ]]; then
  echo "No wallpapers found in $wallpaper_dir"
  exit 1
fi

random_wallpaper="${wallpapers[RANDOM % ${#wallpapers[@]}]}"

swww img "$random_wallpaper" --transition-type simple --transition-fps 60 --transition-step 10
echo "Wallpaper set: $random_wallpaper"
